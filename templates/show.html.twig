{% extends 'layouts/base.html.twig' %}

{% block title %}
SnowTricks
{% endblock %}

{% block body %}
    <header class="mb-auto container mt-3">
        <div class=" justify-content-center text-bg-dark header-trick" style='background-image: url("{{ asset('/uploads/'~trick.image) }}" );'>
            <div class="d-flex justify-content-end">
                <div class="col-md-1 mt-2 bg-white text-center p-2">
                        {% if app.user %}
                        <div>
                            <small class="p-3 icon"><a href="{{ path('edit',{'id':trick.id}) }}" ><i class="fa-solid fa-pencil"></i></a></small>
                            <small class="p-1 icon"><a href="#" class="link"><i class="fa-solid fa-trash"></i></a></small>
                        </div>
                        {% endif %}
                    </div>
            </div>
            <div class="row rounded text-center mt-5">
                <div class="col-md-12 mt-5">
                    <h1 class="display-4 text-white">{{ trick.name }}</h1>
                </div>
            </div>
        </div>
    </header>
    
	<main class="container">
        <div class="container px-4 py-5" id="custom-cards">
            <div class="row py-5">
                <div class="col-12">
                    <p>{{ trick.content }}</p>
                </div>
            </div>  
  
            <div class="row">
                <div class="bd-example-snippet bd-code-snippet">
                    <div class="bd-example">
                        <span class="badge rounded-pill bg-dark">{{ trick.category.name }}</span>
                        <span class="badge rounded-pill bg-dark">{{ trick.createdAt|date('d-m-Y') }}</span>
                    </div>
                </div>
            </div>
            {{ form_start(CommentFormType) }}
                {{ form_row(CommentFormType.content) }}
                <button type="submit" class="btn btn-lg btn-primary btn-block mt-4">Save</button>
            {{ form_end(CommentFormType) }}
            {% for comment in comments %}
                <div class="card m-2">
                    <div class="card-body">
                        <h5 class="card-title">Comment</h5>
                        <p class="card-text">{{ comment.content }}</p>
                    </div>
                </div>
            {% endfor %}
        </div>	
	</main>

<script type="text/javascript" >

//    window.onload = () => {
//    // Gestion des boutons "Supprimer"
//    let link = document.querySelectorAll("#comment_form_name")
//    console.log(link);
//    // On écoute le clic
//    link.addEventListener("click", function(e){
//        // On envoie une requête Ajax vers le href du lien avec la méthode DELETE
//        fetch(this.getAttribute("href"), {
//            method: "POST",
//            headers: {
//                "X-Requested-With": "XMLHttpRequest",
//                "Content-Type": "application/json"
//            },
//            body: JSON.stringify({"_token": this.dataset.token})
//        }).then(
//            // On récupère la réponse en JSON
//            response => response.json()
//        ).then(data => {
//            if(data.success)
//                this.parentElement.remove()
//            else
//                alert(data.error)
//        }).catch(e => alert(e))
//    })
    
//}
</script>
{% endblock %}